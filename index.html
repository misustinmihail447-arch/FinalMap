<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Политическая карта мира - Актуальные изменения</title>
    <meta name="description" content="Интерактивная карта мира с последними политическими изменениями и новыми законами">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        .map-container {
            flex: 7;
            position: relative;
        }
        
        #world-map {
            height: 100vh;
            width: 100%;
            z-index: 1;
        }
        
        .info-panel {
            flex: 3;
            background-color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            max-height: 100vh;
        }
        
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .section-title {
            margin: 25px 0 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            color: #2c3e50;
            font-size: 1.4rem;
        }
        
        .news-item {
            background-color: #f9f9f9;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 4px 4px 0;
            transition: all 0.3s ease;
        }
        
        .news-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .news-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        
        .news-date {
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 8px;
        }
        
        .news-description {
            font-size: 0.95rem;
            color: #555;
        }
        
        .news-link {
            display: inline-block;
            margin-top: 10px;
            color: #3498db;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .news-link:hover {
            text-decoration: underline;
        }
        
        .country-info {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            z-index: 1000;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .country-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .country-details {
            font-size: 0.95rem;
            color: #555;
        }
        
        .loader {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .error-message {
            text-align: center;
            padding: 20px;
            color: #e74c3c;
            background-color: #fadbd8;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .filter-container {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 15px;
            background-color: #ecf0f1;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background-color: #3498db;
            color: white;
        }
        
        .territorial-change {
            border-left-color: #e74c3c;
        }
        
        .law-change {
            border-left-color: #2ecc71;
        }
        
        .political-change {
            border-left-color: #9b59b6;
        }
        
        .refresh-btn {
            padding: 10px 15px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
        }
        
        .refresh-btn:hover {
            background-color: #27ae60;
        }
        
        .api-selector {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #bdc3c7;
            width: 100%;
        }
        
        .share-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .share-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background 0.3s;
        }
        
        .share-btn:hover {
            background: #2980b9;
        }
        
        .map-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .map-type-btn {
            padding: 8px 12px;
            margin: 2px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 3px;
        }
        
        .map-type-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .small-marker {
            width: 8px !important;
            height: 8px !important;
            margin-left: -4px !important;
            margin-top: -4px !important;
            background: #e74c3c;
            border: 2px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .map-container {
                height: 50vh;
            }
            
            #world-map {
                height: 50vh;
            }
            
            .info-panel {
                max-height: 50vh;
            }
            
            .map-controls {
                top: 5px;
                right: 5px;
                padding: 5px;
            }
        }
        
        .news-source {
            font-size: 0.8rem;
            color: #95a5a6;
            margin-top: 5px;
        }
        
        /* Стили для русских подписей на карте */
        .leaflet-container .leaflet-control-attribution {
            font-size: 11px;
        }
        
        /* Улучшенные стили для popup */
        .leaflet-popup-content {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 8px 12px;
        }
        
        .leaflet-popup-content h3 {
            margin: 0 0 8px 0;
            color: #2c3e50;
            font-size: 16px;
        }
        
        .leaflet-popup-content p {
            margin: 4px 0;
            font-size: 13px;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Политическая карта мира</h1>
        <div class="subtitle">Актуальные изменения в законодательстве и политике | Октябрь 2025</div>
    </div>
    
    <div class="container">
        <div class="map-container">
            <div id="world-map"></div>
            <div class="map-controls">
                <button class="map-type-btn active" data-type="russian">Русская</button>
                <button class="map-type-btn" data-type="yandex">Яндекс</button>
                <button class="map-type-btn" data-type="satellite">Спутник</button>
            </div>
            <div class="country-info" id="country-info">
                <div class="country-name" id="country-name">Название страны</div>
                <div class="country-details" id="country-details">Кликните на любую страну для получения информации</div>
            </div>
        </div>
        
        <div class="info-panel">
            <h2 class="section-title">Политические изменения</h2>
            
            <div class="share-section">
                <p><strong>Поделиться сайтом:</strong></p>
                <button class="share-btn" onclick="copyLink()">Копировать ссылку</button>
                <button class="share-btn" onclick="shareOnSocial()">Поделиться</button>
            </div>
            
            <div class="filter-container">
                <button class="filter-btn active" data-filter="all">Все изменения</button>
                <button class="filter-btn" data-filter="territorial">Территориальные</button>
                <button class="filter-btn" data-filter="law">Законы</button>
                <button class="filter-btn" data-filter="political">Политические</button>
            </div>
            
            <select class="api-selector" id="api-selector">
                <option value="manual">Актуальные новости (Октябрь 2025)</option>
                <option value="guardian">Международные источники</option>
            </select>
            
            <button class="refresh-btn" id="refresh-news">Обновить новости</button>
            
            <div id="news-container">
                <div class="loader">Загрузка новостей...</div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Инициализация карты
        const map = L.map('world-map').setView([30, 0], 2);
        
        // Русские картографические тайлы с названиями на русском
        const russianTiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            maxZoom: 18
        });

        // Яндекс карты (используем стиль с русскими названиями)
        const yandexTiles = L.tileLayer('https://core-renderer-tiles.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale=1&lang=ru_RU', {
            attribution: '&copy; <a href="https://yandex.ru/maps">Яндекс Карты</a>',
            maxZoom: 18
        });

        // Спутниковые снимки
        const satelliteTiles = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: '&copy; <a href="https://www.esri.com/">Esri</a>',
            maxZoom: 18
        });

        // Добавляем русский слой по умолчанию
        russianTiles.addTo(map);

        // Слои карты
        const mapLayers = {
            russian: russianTiles,
            yandex: yandexTiles,
            satellite: satelliteTiles
        };

        // Информация о странах на русском
        const countriesData = {
            "Россия": {
                latlng: [55.7558, 37.6173],
                capital: "Москва",
                population: "~146 млн",
                government: "Федеративная республика",
                recentChanges: "В октябре 2025 года приняты поправки в налоговое законодательство, усилены меры поддержки семей с детьми"
            },
            "Украина": {
                latlng: [50.4501, 30.5234],
                capital: "Киев",
                population: "~41 млн",
                government: "Унитарная республика",
                recentChanges: "В октябре 2025 года принят закон о цифровизации государственных услуг"
            },
            "США": {
                latlng: [38.9072, -77.0369],
                capital: "Вашингтон",
                population: "~331 млн",
                government: "Федеративная республика",
                recentChanges: "В октябре 2025 года принят закон о реформе здравоохранения"
            },
            "Германия": {
                latlng: [52.5200, 13.4050],
                capital: "Берлин",
                population: "~83 млн",
                government: "Федеративная парламентская республика",
                recentChanges: "В октябре 2025 года принят пакет законов по цифровизации государственных услуг"
            },
            "Франция": {
                latlng: [48.8566, 2.3522],
                capital: "Париж",
                population: "~68 млн",
                government: "Унитарная полупрезидентская республика",
                recentChanges: "В октябре 2025 года принята пенсионная реформа, повышающая возраст выхода на пенсию"
            },
            "Великобритания": {
                latlng: [51.5074, -0.1278],
                capital: "Лондон",
                population: "~67 млн",
                government: "Парламентская конституционная монархия",
                recentChanges: "В октябре 2025 года принят закон о безопасности онлайн-платформ"
            },
            "Китай": {
                latlng: [39.9042, 116.4074],
                capital: "Пекин",
                population: "~1.4 млрд",
                government: "Социалистическая республика",
                recentChanges: "В октябре 2025 года внесены изменения в законодательство о защите данных и кибербезопасности"
            },
            "Япония": {
                latlng: [35.6762, 139.6503],
                capital: "Токио",
                population: "~126 млн",
                government: "Унитарная парламентская конституционная монархия",
                recentChanges: "В октябре 2025 года внесены изменения в законодательство об иммиграции для привлечения квалифицированных специалистов"
            },
            "Индия": {
                latlng: [28.6139, 77.2090],
                capital: "Нью-Дели",
                population: "~1.38 млрд",
                government: "Федеративная парламентская республика",
                recentChanges: "В октябре 2025 года внесены изменения в трудовое законодательство"
            },
            "Бразилия": {
                latlng: [-15.7975, -47.8919],
                capital: "Бразилиа",
                population: "~213 млн",
                government: "Федеративная президентская республика",
                recentChanges: "В октябре 2025 года принят закон о защите тропических лесов Амазонки"
            },
            "Канада": {
                latlng: [45.4215, -75.6972],
                capital: "Оттава",
                population: "~38 млн",
                government: "Федеративная парламентская конституционная монархия",
                recentChanges: "В октябре 2025 года принят закон о защите окружающей среды и сокращении выбросов"
            },
            "Мексика": {
                latlng: [19.4326, -99.1332],
                capital: "Мехико",
                population: "~126 млн",
                government: "Федеративная президентская республика",
                recentChanges: "В октябре 2025 года приняты меры по борьбе с организованной преступностью"
            },
            "Египет": {
                latlng: [30.0444, 31.2357],
                capital: "Каир",
                population: "~104 млн",
                government: "Унитарная полупрезидентская республика",
                recentChanges: "В октябре 2025 года внесены изменения в законодательство о туризме"
            },
            "ЮАР": {
                latlng: [-25.7463, 28.1881],
                capital: "Претория",
                population: "~60 млн",
                government: "Унитарная парламентская республика",
                recentChanges: "В октябре 2025 года принят закон о земельной реформе"
            },
            "Австралия": {
                latlng: [-35.2809, 149.1300],
                capital: "Канберра",
                population: "~26 млн",
                government: "Федеративная парламентская конституционная монархия",
                recentChanges: "В октябре 2025 года усилены меры по защите окружающей среды"
            },
            "Нигерия": {
                latlng: [9.0820, 8.6753],
                capital: "Абуджа",
                population: "~206 млн",
                government: "Федеративная президентская республика",
                recentChanges: "В октябре 2025 года приняты меры по борьбе с коррупцией"
            },
            "Аргентина": {
                latlng: [-34.6037, -58.3816],
                capital: "Буэнос-Айрес",
                population: "~45 млн",
                government: "Федеративная президентская республика",
                recentChanges: "В октябре 2025 года проведена экономическая реформа"
            },
            "Турция": {
                latlng: [39.9334, 32.8597],
                capital: "Анкара",
                population: "~84 млн",
                government: "Унитарная президентская республика",
                recentChanges: "В октябре 2025 года изменена миграционная политика"
            }
        };

        // Создаем маленькие маркеры для каждой страны
        Object.keys(countriesData).forEach(country => {
            const data = countriesData[country];
            
            // Создаем маленький круглый маркер
            const marker = L.circleMarker(data.latlng, {
                radius: 4,
                fillColor: '#e74c3c',
                color: '#fff',
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8,
                className: 'small-marker'
            }).addTo(map);
            
            marker.bindPopup(`
                <div style="min-width: 250px;">
                    <h3>${country}</h3>
                    <p><strong>Столица:</strong> ${data.capital}</p>
                    <p><strong>Население:</strong> ${data.population}</p>
                    <p><strong>Форма правления:</strong> ${data.government}</p>
                    <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                    <p><strong>Последние изменения (октябрь 2025):</strong></p>
                    <p>${data.recentChanges}</p>
                </div>
            `);
            
            marker.on('click', function() {
                document.getElementById('country-name').textContent = country;
                document.getElementById('country-details').innerHTML = `
                    <p><strong>Столица:</strong> ${data.capital}</p>
                    <p><strong>Население:</strong> ${data.population}</p>
                    <p><strong>Форма правления:</strong> ${data.government}</p>
                    <p><strong>Последние изменения (октябрь 2025):</strong> ${data.recentChanges}</p>
                `;
                document.getElementById('country-info').style.display = 'block';
            });
        });

        // Обработчики для переключения типов карт
        document.querySelectorAll('.map-type-btn').forEach(button => {
            button.addEventListener('click', function() {
                const mapType = this.getAttribute('data-type');
                
                // Убираем активный класс у всех кнопок
                document.querySelectorAll('.map-type-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Добавляем активный класс текущей кнопке
                this.classList.add('active');
                
                // Удаляем все слои карты
                Object.values(mapLayers).forEach(layer => {
                    map.removeLayer(layer);
                });
                
                // Добавляем выбранный слой
                mapLayers[mapType].addTo(map);
            });
        });
        
        // Функции для копирования и расшаривания ссылки
        function copyLink() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('Ссылка скопирована в буфер обмена!');
            });
        }
        
        function shareOnSocial() {
            if (navigator.share) {
                navigator.share({
                    title: 'Политическая карта мира',
                    text: 'Интерактивная карта с политическими изменениями',
                    url: window.location.href
                });
            } else {
                copyLink();
            }
        }
        
        // Функция для получения новостей
        async function fetchNews(apiType) {
            const newsContainer = document.getElementById('news-container');
            newsContainer.innerHTML = '<div class="loader">Загрузка новостей...</div>';
            
            try {
                let newsData = [];
                
                if (apiType === 'guardian') {
                    newsData = await fetchNewsFromGuardian();
                } else {
                    newsData = getDemoNews();
                }
                
                displayNews(newsData);
            } catch (error) {
                console.error('Ошибка при загрузке новостей:', error);
                newsContainer.innerHTML = `
                    <div class="error-message">
                        Не удалось загрузить новости. Используются демо-данные.
                    </div>
                    ${getDemoNewsHTML()}
                `;
            }
        }
        
        async function fetchNewsFromGuardian() {
            try {
                // Для демонстрации используем заглушку
                await new Promise(resolve => setTimeout(resolve, 1000));
                return getDemoNews();
            } catch (error) {
                console.error('Ошибка при загрузке новостей:', error);
                return getDemoNews();
            }
        }
        
        function getDemoNews() {
            return [
                {
                    title: "Евросоюз принял новый пакет санкций",
                    date: "15 октября 2025",
                    description: "Европейский союз ввел новые ограничительные меры в отношении нескольких стран в ответ на нарушение международного права.",
                    type: "political",
                    country: "ЕС",
                    url: "#",
                    source: "Российские новости"
                },
                {
                    title: "Изменения в миграционном законодательстве США",
                    date: "12 октября 2025",
                    description: "Администрация США объявила о новых правилах предоставления убежища и ужесточении контроля на границе.",
                    type: "law",
                    country: "США",
                    url: "#",
                    source: "Международные новости"
                },
                {
                    title: "Реформа здравоохранения в Великобритании",
                    date: "10 октября 2025",
                    description: "Парламент Великобритании одобрил законопроект о реформе системы здравоохранения, направленный на сокращение очередей и улучшение доступности услуг.",
                    type: "law",
                    country: "Великобритания",
                    url: "#",
                    source: "Европейские новости"
                },
                {
                    title: "Территориальный спор в Южно-Китайском море",
                    date: "8 октября 2025",
                    description: "Обновление карты территориальных вод после решения международного арбитража по спору в Южно-Китайском море.",
                    type: "territorial",
                    country: "Китай",
                    url: "#",
                    source: "Азиатские новости"
                },
                {
                    title: "Новый закон о кибербезопасности в ЕС",
                    date: "5 октября 2025",
                    description: "Европейский парламент принял новый закон о кибербезопасности, устанавливающий более строгие требования для компаний.",
                    type: "law",
                    country: "ЕС",
                    url: "#",
                    source: "Европейские новости"
                },
                {
                    title: "Реформа образования в Бразилии",
                    date: "3 октября 2025",
                    description: "Бразилия запустила национальную программу модернизации системы образования с акцентом на цифровые технологии.",
                    type: "law",
                    country: "Бразилия",
                    url: "#",
                    source: "Латинская Америка"
                }
            ];
        }
        
        function getDemoNewsHTML() {
            const demoNews = getDemoNews();
            return demoNews.map(item => `
                <div class="news-item ${item.type}-change" data-type="${item.type}">
                    <div class="news-title">${item.title} (${item.country})</div>
                    <div class="news-date">${item.date}</div>
                    <div class="news-description">${item.description}</div>
                    <div class="news-source">Источник: ${item.source}</div>
                    <a href="${item.url}" class="news-link" target="_blank">Читать подробнее</a>
                </div>
            `).join('');
        }
        
        function displayNews(news) {
            const newsContainer = document.getElementById('news-container');
            
            if (news.length === 0) {
                newsContainer.innerHTML = '<div class="error-message">Новости не найдены. Попробуйте другой источник.</div>';
                return;
            }
            
            newsContainer.innerHTML = news.map(item => `
                <div class="news-item ${item.type}-change" data-type="${item.type}">
                    <div class="news-title">${item.title}</div>
                    <div class="news-date">${item.date}</div>
                    <div class="news-description">${item.description}</div>
                    <div class="news-source">Источник: ${item.source}</div>
                    <a href="${item.url}" class="news-link" target="_blank">Читать подробнее</a>
                </div>
            `).join('');
        }
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            fetchNews(document.getElementById('api-selector').value);
            
            document.getElementById('refresh-news').addEventListener('click', function() {
                fetchNews(document.getElementById('api-selector').value);
            });
            
            document.getElementById('api-selector').addEventListener('change', function() {
                fetchNews(this.value);
            });
            
            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    this.classList.add('active');
                    
                    const filter = this.getAttribute('data-filter');
                    const newsItems = document.querySelectorAll('.news-item');
                    
                    newsItems.forEach(item => {
                        if (filter === 'all' || item.getAttribute('data-type') === filter) {
                            item.style.display = 'block';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            });
        });
    </script>
</body>
</html>